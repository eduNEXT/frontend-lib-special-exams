{"version":3,"file":"ExamWrapper.js","names":["_reactRedux","require","_react","_interopRequireWildcard","_react2","_propTypes","_interopRequireDefault","_Exam","_data","_jsxRuntime","_excluded","obj","__esModule","default","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","_objectWithoutProperties","source","excluded","target","_objectWithoutPropertiesLoose","i","getOwnPropertySymbols","sourceSymbolKeys","length","indexOf","propertyIsEnumerable","sourceKeys","keys","ExamWrapper","_ref","children","props","authenticatedUser","useContext","AppContext","sequence","courseId","isStaff","originalUserIsStaff","canAccessProctoredExams","isLoading","useSelector","state","specialExams","dispatch","useDispatch","loadInitialData","getExamAttemptsData","id","getAllowProctoringOptOut","allowProctoringOptOut","checkExamEntry","isGated","gatedContent","undefined","gated","useEffect","isTimeLimited","jsx","propTypes","PropTypes","shape","string","isRequired","bool","element","defaultProps","_default","exports"],"sources":["../../src/exam/ExamWrapper.jsx"],"sourcesContent":["import { useDispatch, useSelector } from 'react-redux';\nimport React, { useContext, useEffect } from 'react';\nimport { AppContext } from '@edx/frontend-platform/react';\nimport PropTypes from 'prop-types';\nimport Exam from './Exam';\nimport {\n  getExamAttemptsData,\n  getAllowProctoringOptOut,\n  checkExamEntry,\n} from '../data';\n\n/**\n * Exam wrapper is responsible for triggering initial exam data fetching and rendering Exam.\n */\nconst ExamWrapper = ({ children, ...props }) => {\n  const { authenticatedUser } = useContext(AppContext);\n  const {\n    sequence,\n    courseId,\n    isStaff,\n    originalUserIsStaff,\n    canAccessProctoredExams,\n  } = props;\n\n  const { isLoading } = useSelector(state => state.specialExams);\n\n  const dispatch = useDispatch();\n\n  const loadInitialData = async () => {\n    await dispatch(getExamAttemptsData(courseId, sequence.id));\n    await getAllowProctoringOptOut(sequence.allowProctoringOptOut);\n    await checkExamEntry();\n  };\n\n  const isGated = sequence && sequence.gatedContent !== undefined && sequence.gatedContent.gated;\n\n  useEffect(() => {\n    // fetch exam data on exam sequences or if no exam data has been fetched yet\n    if (sequence.isTimeLimited || isLoading) {\n      loadInitialData();\n    }\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  // if the user is browsing public content (not logged in) they cannot be in an exam\n  // if the user is staff they may view exam content without an exam attempt\n  // any requests for exam state will 403 so just short circuit this component here\n  if (!authenticatedUser || isStaff) {\n    return children;\n  }\n\n  return (\n    <Exam\n      isGated={isGated}\n      isTimeLimited={sequence.isTimeLimited}\n      originalUserIsStaff={originalUserIsStaff}\n      canAccessProctoredExams={canAccessProctoredExams}\n    >\n      {children}\n    </Exam>\n  );\n};\n\nExamWrapper.propTypes = {\n  sequence: PropTypes.shape({\n    id: PropTypes.string.isRequired,\n    isTimeLimited: PropTypes.bool,\n    allowProctoringOptOut: PropTypes.bool,\n    gatedContent: PropTypes.shape({\n      gated: PropTypes.bool,\n    }),\n  }).isRequired,\n  courseId: PropTypes.string.isRequired,\n  children: PropTypes.element.isRequired,\n  isStaff: PropTypes.bool,\n  originalUserIsStaff: PropTypes.bool,\n  canAccessProctoredExams: PropTypes.bool,\n};\n\nExamWrapper.defaultProps = {\n  isStaff: false,\n  originalUserIsStaff: false,\n  canAccessProctoredExams: true,\n};\n\nexport default ExamWrapper;\n"],"mappings":"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"}